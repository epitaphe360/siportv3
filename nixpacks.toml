# Nixpacks Configuration for SIPORTS Web Application
# Force Node.js build only, ignore Deno/mobile apps detection

# Use Node.js 20 latest (required for eslint, cheerio, jsdom >=20.18.1)
# Railway default 20.6.1 causes EBADENGINE warnings
[phases.setup]
nixPkgs = ["nodejs-20_x"]

# Install dependencies with optimizations
[phases.install]
cmds = [
  "npm ci --prefer-offline --no-audit --loglevel=error || npm install --prefer-offline --no-audit"
]

# Build the web application with Vite
[phases.build]
cmds = ["npm run build"]

# Start command for production preview server
[start]
cmd = "npm run preview"

